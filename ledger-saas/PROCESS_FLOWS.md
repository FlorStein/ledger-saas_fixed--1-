# ğŸ”„ Flujos de Procesamiento - Ledger SaaS

## A) Flujo de Matching Inteligente

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRANSACCIÃ“N INGRESADA                                               â”‚
â”‚ - Monto: 1.000 ARS                                                  â”‚
â”‚ - CUIT: 20123456789                                                 â”‚
â”‚ - Nombre: "Cliente A"                                               â”‚
â”‚ - Fecha: 2025-12-29 10:00                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Â¿Tiene operation_id? â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†™                â†–
                  SÃ                   NO
                  â†“                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Buscar candidatos
        â”‚ Buscar venta con â”‚   en ventana de
        â”‚ external_ref     â”‚   Â±DATE_WINDOW_HOURS
        â”‚ exacto           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Â¿EncontrÃ³?       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†™              â†–
        SÃ                NO
        â†“                 â†“
    âœ… MATCHED         Seguir con
    method="           scoring
    strong_id"
    score=100
    needs_review=false
                        â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Calcular scores:     â”‚
                  â”‚ - Base: 60           â”‚
                  â”‚ - Fecha: +5 a +25    â”‚
                  â”‚ - CUIT: +10 o +20    â”‚
                  â”‚ - TelÃ©fono: +15      â”‚
                  â”‚ - Nombre: +2 a +10   â”‚
                  â”‚ - Referencia: +15    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Candidatos: [C1, C2] â”‚
                  â”‚ C1 score=90          â”‚
                  â”‚ C2 score=70          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Â¿Solo 1 candidato viable?     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†™                           â†–
        SÃ                             NO
        â†“                              â†“
    Â¿score >= threshold?         Â¿C1.score >= threshold?
    (default 85)                 (default 85)
        â†™        â†–                     â†“
      SÃ         NO              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â†“          â†“               â”‚ gap = C1 - C2   â”‚
   MATCHED    UNMATCHED          â”‚ gap >= 10?      â”‚
   method=    method=            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   single_    low_score            â†™              â†–
   candidate                      SÃ              NO
   score=?                        â†“               â†“
   needs_     needs_review=    âœ… MATCHED    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   review=    false            method=       â”‚ Tie-break    â”‚
   false                        "gap"         â”‚              â”‚
                                score=?       â”‚ 1. Evidencia â”‚
                                needs_review= â”‚ 2. Fecha     â”‚
                                false         â”‚ 3. ID menor  â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â†“
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚ Â¿Se resolviÃ³?â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â†™          â†–
                                              SÃ            NO
                                              â†“             â†“
                                          âœ… MATCHED   âš ï¸ AMBIGUOUS
                                          method=     method=
                                          "tiebreak"  "needs_review"
                                          score=?     needs_review=
                                          needs_     true
                                          review=false
                                                      
                                              â†“ (usuario revisa
                                              |  en UI)
                                              â†“
                                          âœ… CONFIRMADO
                                          o RECHAZADO
```

---

## B) Flujo de Ingest de Venta (Imagen/PDF)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USUARIO SUBE ARCHIVO                     â”‚
â”‚ - Imagen (JPG/PNG/etc) o PDF             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ POST /sales/ingest     â”‚
        â”‚ multipart/form-data    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Â¿Formato vÃ¡lido?      â”‚
        â”‚ (PDF, JPG, PNG...)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†™                    â†–
        SÃ                     NO
        â†“                      â†“
    Guardar temp          âŒ ERROR 400
        â†“                  "Formato no
        â†“                  soportado"
    Â¿Es PDF?
      â†™   â†–
    SÃ    NO
    â†“     â†“
    â”‚    OCR con
    â”‚    pytesseract
    â”‚     â†“
    Extraer texto
    con pdfplumber
         â†“
         â””â”€â”€â”€â”€â†’ raw_text
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ parse_sale_from_text() â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Extracciones:          â”‚
        â”‚ - extract_amount()     â”‚
        â”‚ - extract_datetime()   â”‚
        â”‚ - extract_customer_    â”‚
        â”‚   name()               â”‚
        â”‚ - extract_phone()      â”‚
        â”‚ - extract_cuit()       â”‚
        â”‚ - extract_reference()  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Retornar DRAFT:        â”‚
        â”‚ {                      â”‚
        â”‚   "draft": true,       â”‚
        â”‚   "amount": 1234.56,   â”‚
        â”‚   "datetime": "...",   â”‚
        â”‚   "customer_name": ...,â”‚
        â”‚   "customer_phone": ...,
        â”‚   "customer_cuit": ...,â”‚
        â”‚   "external_ref": ..., â”‚
        â”‚   "raw_text": "...",   â”‚
        â”‚   "currency": "ARS"    â”‚
        â”‚ }                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ FRONTEND                 â”‚
        â”‚ Mostrar formulario con   â”‚
        â”‚ campos prellenados        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Usuario REVISA y         â”‚
        â”‚ puede EDITAR campos      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Usuario hace click:      â”‚
        â”‚ "Guardar venta"          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ POST /v1/sales con       â”‚
        â”‚ los valores del draft    â”‚
        â”‚ (editados si aplica)     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ âœ… Venta creada en BD    â”‚
        â”‚ - amount                 â”‚
        â”‚ - datetime               â”‚
        â”‚ - customer_name          â”‚
        â”‚ - customer_phone         â”‚
        â”‚ - customer_cuit          â”‚
        â”‚ - external_ref           â”‚
        â”‚ - status="open"          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Dashboard actualiza      â”‚
        â”‚ tabla de ventas          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## C) Flujo de Tie-Break DeterminÃ­stico

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MÃºltiples candidatos con            â”‚
â”‚ scores muy cercanos o iguales       â”‚
â”‚ gap < AUTO_MATCH_GAP (default 10)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CRITERIO 1: Evidence Rank    â”‚
    â”‚                              â”‚
    â”‚ CUIT exacto    â†’ 100         â”‚
    â”‚ Ref exacta     â†’ 90          â”‚
    â”‚ TelÃ©fono       â†’ 80          â”‚
    â”‚ Nombre parcial â†’ 70          â”‚
    â”‚ Monto exacto   â†’ 60          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Candidato A: evidence_rank=100 (tiene CUIT)
    Candidato B: evidence_rank=80  (tiene phone)
         â†“
    âœ… A gana por mejor evidencia
    
    
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Caso 2: Evidencia IGUAL
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CRITERIO 2: Time Delta       â”‚
    â”‚                              â”‚
    â”‚ Â¿CuÃ¡l estÃ¡ mÃ¡s cerca en      â”‚
    â”‚ fecha/hora a la transacciÃ³n? â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Candidato A: 2025-12-29 10:00
    TransacciÃ³n: 2025-12-29 10:05
    Delta = 5 minutos
    
    Candidato B: 2025-12-29 10:00
    TransacciÃ³n: 2025-12-29 10:05
    Delta = 5 minutos (IGUAL)
         â†“
    
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Caso 3: Fecha IGUAL tambiÃ©n
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CRITERIO 3: Sale ID Menor    â”‚
    â”‚                              â”‚
    â”‚ Si todo lo demÃ¡s es igual,   â”‚
    â”‚ elegir el de menor ID        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Candidato A: id=10
    Candidato B: id=15
         â†“
    âœ… A gana por ID menor
         â†“
    result = {
        "status": "matched",
        "method": "tiebreak",
        "sale_id": 10,
        "score": 85,
        "needs_review": false
    }
```

---

## D) Matriz de DecisiÃ³n de Match

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ CondiciÃ³n          â•‘ Status      â•‘ Method     â•‘ Score Ref     â•‘ Needs Review   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ operation_id ==    â•‘ matched     â•‘ strong_id  â•‘ 100           â•‘ false          â•‘
â•‘ external_ref       â•‘             â•‘            â•‘               â•‘                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ 1 candidato +      â•‘ matched     â•‘ single_    â•‘ >= 85         â•‘ false          â•‘
â•‘ score >= 85        â•‘             â•‘ candidate  â•‘               â•‘                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ top - second >= 10 â•‘ matched     â•‘ gap        â•‘ >= 85         â•‘ false          â•‘
â•‘ + top >= 85        â•‘             â•‘            â•‘               â•‘                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ gap < 10 +         â•‘ matched     â•‘ tiebreak   â•‘ >= 85         â•‘ false          â•‘
â•‘ Se resolviÃ³        â•‘             â•‘            â•‘               â•‘                â•‘
â•‘ por evidencia/     â•‘             â•‘            â•‘               â•‘                â•‘
â•‘ fecha/id           â•‘             â•‘            â•‘               â•‘                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ No se puede        â•‘ ambiguous   â•‘ needs_     â•‘ < 85 o        â•‘ TRUE           â•‘
â•‘ romper empate      â•‘             â•‘ review     â•‘ indeciso      â•‘                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Top score < 85     â•‘ unmatched   â•‘ low_score  â•‘ < 85          â•‘ false          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Sin candidatos     â•‘ unmatched   â•‘ no_        â•‘ 0             â•‘ false          â•‘
â•‘ o sin monto/fecha  â•‘             â•‘ candidates â•‘               â•‘                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## E) Pipeline de OCR/PDF

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Archivo subido   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Â¿PDF?
    â†™   â†–
   SÃ   NO (Imagen)
   â†“    â†“
   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    â”‚ PIL.Image.open() â”‚
   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚         â†“
   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    â”‚ pytesseract.image_to â”‚
   â”‚    â”‚ _string(image,       â”‚
   â”‚    â”‚ lang='spa')          â”‚
   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚         â†“
   â”‚    raw_text (OCR)
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ pdfplumber.open()â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ extract_text()    â”‚
    â”‚ para cada pÃ¡gina  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    raw_text (PDF)
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ REGEX PATTERNS            â”‚
    â”‚                           â”‚
    â”‚ Amount:                   â”‚
    â”‚ \d{1,3}(?:\.\d{3})*,\d{2} â”‚
    â”‚ (formato argentino)       â”‚
    â”‚                           â”‚
    â”‚ Phone:                    â”‚
    â”‚ +54 9? (\d{2,4}...)       â”‚
    â”‚ 1112345678                â”‚
    â”‚                           â”‚
    â”‚ CUIT:                     â”‚
    â”‚ \d{2}[\s-]?\d{8}[\s-]?\d  â”‚
    â”‚                           â”‚
    â”‚ Reference:                â”‚
    â”‚ (?:pedido|ref)[:\s#]*(..) â”‚
    â”‚                           â”‚
    â”‚ Date:                     â”‚
    â”‚ \d{1,2}[/-]\d{1,2}[/-]    â”‚
    â”‚ \d{2,4}                   â”‚
    â”‚                           â”‚
    â”‚ Customer:                 â”‚
    â”‚ (?:cliente|nombre)[:\s].. â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Parsed Data Dict:      â”‚
    â”‚ {                      â”‚
    â”‚  amount: 1234.56,      â”‚
    â”‚  datetime: "2025-...", â”‚
    â”‚  customer_name: "...", â”‚
    â”‚  customer_phone: "...",â”‚
    â”‚  customer_cuit: "...", â”‚
    â”‚  external_ref: "...",  â”‚
    â”‚  raw_text: "..."       â”‚
    â”‚ }                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Ãšltima actualizaciÃ³n**: 29 de diciembre de 2025
